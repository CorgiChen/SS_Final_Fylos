{"version":3,"sources":["assets\\Script\\Crate.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Crate extends cc.Component {\r\n    private rigidbody: cc.RigidBody = null;\r\n    private collider: cc.PhysicsBoxCollider = null;\r\n    private onGround: boolean = false;\r\n\r\n    onLoad() {\r\n        // 啟用物理系統\r\n        const manager = cc.director.getPhysicsManager();\r\n        manager.enabled = true;\r\n        // 初始化剛體\r\n        this.rigidbody = this.getComponent(cc.RigidBody);\r\n        if (!this.rigidbody) {\r\n            this.rigidbody = this.node.addComponent(cc.RigidBody);\r\n        }\r\n        this.rigidbody.type = cc.RigidBodyType.Dynamic;\r\n        this.rigidbody.fixedRotation = true;\r\n        this.rigidbody.gravityScale = 10; // 箱子很重但不會過重\r\n        this.rigidbody.linearDamping = 0.5;\r\n        this.rigidbody.enabledContactListener = true;\r\n        this.rigidbody.allowSleep = false;\r\n        // 初始化碰撞器\r\n        this.collider = this.getComponent(cc.PhysicsBoxCollider);\r\n        if (!this.collider) {\r\n            this.collider = this.node.addComponent(cc.PhysicsBoxCollider);\r\n        }\r\n        this.collider.enabled = true;\r\n        this.collider.sensor = false;\r\n        this.collider.friction = 1.0;\r\n        this.collider.restitution = 0;\r\n        // 自動調整碰撞箱大小與位置\r\n        const size = this.node.getContentSize();\r\n        this.collider.size = cc.size(size.width, size.height);\r\n        this.collider.offset = cc.v2(0, 0);\r\n        this.collider.apply();\r\n    }\r\n\r\n    // 只允許箱子在地板上停止，不能被推動\r\n    onBeginContact(contact: cc.PhysicsContact, selfCollider: cc.PhysicsCollider, otherCollider: cc.PhysicsCollider) {\r\n        if (otherCollider.node.name === 'Ground') {\r\n            this.onGround = true;\r\n            this.rigidbody.linearVelocity = cc.v2(0, 0);\r\n            this.rigidbody.angularVelocity = 0;\r\n        }\r\n    }\r\n\r\n    // 讓 Wind.ts 可以呼叫這個方法\r\n    public applyWindForce(dir: number) {\r\n        this.rigidbody.linearVelocity = cc.v2(dir * 800, 0);\r\n    }\r\n}\r\n"]}