{"version":3,"sources":["assets\\Script\\AudioManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class AudioManager extends cc.Component {\n    private static _instance: AudioManager = null;\n    public static audioId: number = -1;\n\n    @property({ type: cc.AudioClip })\n    normalBGM: cc.AudioClip = null;\n\n    @property({ type: cc.AudioClip })\n    endingBGM: cc.AudioClip = null;\n\n    @property\n    volume: number = 0.5;\n\n    @property\n    loop: boolean = true;\n\n    public static get instance(): AudioManager {\n        return this._instance;\n    }\n\n    onLoad() {\n        if (AudioManager._instance === null) {\n            AudioManager._instance = this;\n            cc.game.addPersistRootNode(this.node);\n            // 只在第一次 persist 時自動播放\n            this.playNormalBGM();\n            cc.log(AudioManager.audioId);\n        } else {\n            this.node.destroy();\n        }\n    }\n\n    playNormalBGM() {\n        if (this.normalBGM) {\n            this.stopBGM();\n            AudioManager.audioId = cc.audioEngine.play(this.normalBGM, this.loop, this.volume);\n        }\n    }\n\n    playEndingBGM() {\n        if (this.endingBGM) {\n            this.stopBGM();\n            AudioManager.audioId = cc.audioEngine.play(this.endingBGM, this.loop, this.volume);\n        }\n    }\n\n    stopBGM() {\n        if (AudioManager.audioId !== -1) {\n            cc.audioEngine.stop(AudioManager.audioId);\n            AudioManager.audioId = -1;\n        }\n    }\n\n    setVolume(volume: number) {\n        this.volume = volume;\n        // 只要有正在播放的 BGM，立即調整音量\n        if (AudioManager.audioId !== -1) {\n            cc.audioEngine.setVolume(AudioManager.audioId, volume);\n        }\n    }\n\n    // 可選：切換 BGM 時自動用目前 volume\n    switchToNormalBGM() {\n        this.playNormalBGM();\n        this.setVolume(this.volume);\n    }\n\n    switchToEndingBGM() {\n        this.playEndingBGM();\n        this.setVolume(this.volume);\n    }\n\n    onDestroy() {\n        if (AudioManager._instance === this) {\n            AudioManager._instance = null;\n        }\n    }\n} "]}