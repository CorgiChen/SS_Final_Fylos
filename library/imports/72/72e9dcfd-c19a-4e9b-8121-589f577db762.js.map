{"version":3,"sources":["assets\\Script\\Signup.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\ndeclare const firebase: any;\r\n@ccclass\r\nexport default class Signup extends cc.Component {\r\n\r\n    // @property({ type: cc.AudioClip })\r\n    // bgm: cc.AudioClip = null;\r\n\r\n    // Called once when the component is enabled\r\n    start() {\r\n        // Register quit button event\r\n        const quitButton = cc.find(\"small_canvas_bg/quit\");\r\n        if (quitButton) {\r\n            quitButton.on(\r\n                cc.Node.EventType.TOUCH_END,\r\n                this.loadMenuScene,\r\n                this\r\n            );\r\n        }\r\n\r\n        // Register submit button event\r\n        cc.find(\"small_canvas_bg/submit\").on(\r\n            cc.Node.EventType.MOUSE_DOWN,\r\n            this.createAccount,\r\n            this\r\n        );\r\n\r\n        // // Play background music if not already playing\r\n        // if (!cc.audioEngine.isMusicPlaying()) {\r\n        //     this.playBGM();\r\n        // }\r\n    }\r\n\r\n    // Loads the menu scene\r\n    loadMenuScene() {\r\n        const transition = cc.find(\"Canvas/Transition\");\r\n        if (transition) {\r\n            transition.getComponent(\"TransitionManager\").playTransOutAndChangeScene(\"Scene000_Menu\");\r\n        } else {\r\n            cc.director.loadScene(\"Scene000_Menu\");\r\n        }\r\n    }\r\n\r\n    // Called every frame, logs the current username input\r\n    update(dt) {\r\n        const username = cc.find(\"small_canvas_bg/username/TEXT_LABEL\")\r\n            .getComponent(cc.Label).string;\r\n        cc.log(username);\r\n    }\r\n\r\n    // // Plays background music\r\n    // playBGM() {\r\n    //     cc.audioEngine.playMusic(this.bgm, true);\r\n    // }\r\n\r\n    // Handles account creation logic\r\n    private createAccount() {\r\n        // Get user input values\r\n        const email = cc.find(\"small_canvas_bg/email/TEXT_LABEL\")\r\n            .getComponent(cc.Label).string;\r\n        const username = cc.find(\"small_canvas_bg/username/TEXT_LABEL\")\r\n            .getComponent(cc.Label).string;\r\n        const password = cc.find(\"small_canvas_bg/password/TEXT_LABEL\")\r\n            .getComponent(cc.Label).string;\r\n\r\n        // Create user with Firebase Authentication\r\n        firebase.auth().createUserWithEmailAndPassword(email, password)\r\n            .then(result => {\r\n                // Store user data in Firebase Database\r\n                const usersRef = firebase.database().ref('user_list/');\r\n                const emailKey = email.replace(\".\", \"-\");\r\n                usersRef.child(emailKey).set({\r\n                    username: username,\r\n                    email: email,\r\n                    max_stage: \"Scene001_Home_Outside\",\r\n                    death_count: 0,\r\n                    play_time: 0\r\n                });\r\n\r\n                alert(\"You have successfully created the account!\");\r\n                const transition2 = cc.find(\"Canvas/Transition\");\r\n                if (transition2) {\r\n                    transition2.getComponent(\"TransitionManager\").playTransOutAndChangeScene(\"Scene000_Login\");\r\n                } else {\r\n                    cc.director.loadScene(\"Scene000_Login\");\r\n                }\r\n\r\n                // Update user profile with username\r\n                return result.user.updateProfile({\r\n                    displayName: username,\r\n                });\r\n            })\r\n            .catch(error => {\r\n                // Handle errors\r\n                alert(error.message);\r\n            });\r\n    }\r\n}\r\n"]}